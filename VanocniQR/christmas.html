<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<title>V√°noƒçn√≠ QR Quest</title>
<style>
body { background-color: #ffe6e6; font-family: Arial, sans-serif; text-align: center; padding: 50px; }
input { padding: 10px; font-size: 16px; margin: 5px; }
button { padding: 10px 20px; font-size: 16px; background-color: #008000; color: white; border: none; border-radius: 10px; cursor: pointer; margin: 5px; }
button:hover { background-color: #005500; }
#qr-reader { width: 300px; margin: auto; }
</style>
<script src="https://unpkg.com/html5-qrcode"></script>
</head>
<body>
<h1>üéÑ V√°noƒçn√≠ QR Quest üéÖ</h1>
<div id="setup">
  <p>Zadej n√°zev t√Ωmu:</p>
  <input type="text" id="team" required>
  <p>Zadej ƒçleny t√Ωmu (oddƒõlen√© ƒç√°rkou):</p>
  <input type="text" id="members" required>
  <br>
  <button onclick="startGame()">Zaƒç√≠t hru</button>
</div>
<div id="game" style="display:none;">
  <p id="team-info"></p>
  <p id="time">‚è± 0:00</p>
  <div id="clue"></div>
  <div id="qr-reader" style="display:none;"></div>
  <div id="question"></div>
</div>
<script>
let questions = [
  {q: "Jak√© zv√≠≈ôe tah√° Santovy s√°nƒõ?", type: "mc", options: ["A) Sob", "B) K≈Ø≈à", "C) Pes"], a: "A", clue: "Dal≈°√≠ QR k√≥d najde≈° u lednice ve ≈°kole."},
  {q: "Co nos√≠ Je≈æ√≠≈°ek?", type: "text", a: "d√°rky", clue: "Dal≈°√≠ QR k√≥d najde≈° u ≈°atny."},
  {q: "Kolik je na adventn√≠m vƒõnci sv√≠ƒçek?", type: "mc", options: ["A) 3", "B) 4", "C) 5"], a: "B", clue: "Teƒè bƒõ≈æ do uƒçebny 32 ‚Äì tam najde≈° ob√°lku!"}
];

let currentStage = 0;
let startTime;
let timerInterval;

function startGame() {
  const team = document.getElementById('team').value;
  const members = document.getElementById('members').value;
  if(!team || !members) return;
  document.getElementById('setup').style.display = 'none';
  document.getElementById('game').style.display = 'block';
  document.getElementById('team-info').innerText = `T√Ωm: ${team} | ƒålenov√©: ${members}`;
  startTime = new Date();
  document.getElementById('clue').innerText = "Prvn√≠ indicie: Jdƒõte k hlavn√≠mu vchodu ≈°koly.";
  timerInterval = setInterval(updateTimer, 1000);
  showQRScanner();
}

function updateTimer() {
  const now = new Date();
  const diff = Math.floor((now - startTime)/1000);
  const minutes = Math.floor(diff/60);
  const seconds = diff % 60;
  document.getElementById('time').innerText = `‚è± ${minutes}:${seconds.toString().padStart(2,'0')}`;
}

function showQRScanner() {
  document.getElementById('qr-reader').style.display = 'block';
  const html5QrcodeScanner = new Html5QrcodeScanner(
    "qr-reader", { fps: 10, qrbox: 250 });
  html5QrcodeScanner.render(onScanSuccess);
}

function onScanSuccess(decodedText, decodedResult) {
  document.getElementById('qr-reader').style.display = 'none';
  showQuestion();
}

function showQuestion() {
  const q = questions[currentStage];
  const container = document.getElementById('question');
  container.innerHTML = `<h2>${q.q}</h2>`;
  if(q.type === 'mc') {
    q.options.forEach(option => {
      const btn = document.createElement('button');
      btn.innerText = option;
      btn.onclick = () => checkAnswer(option[0]);
      container.appendChild(btn);
    });
  } else if(q.type === 'text') {
    const input = document.createElement('input');
    input.type = 'text';
    input.id = 'textAnswer';
    const btn = document.createElement('button');
    btn.innerText = 'Odpovƒõdƒõt';
    btn.onclick = () => checkAnswer(document.getElementById('textAnswer').value);
    container.appendChild(input);
    container.appendChild(document.createElement('br'));
    container.appendChild(btn);
  }
}

function checkAnswer(answer) {
  const q = questions[currentStage];
  if(answer.trim().toUpperCase() === q.a.toUpperCase()) {
    currentStage++;
    if(currentStage < questions.length) {
      document.getElementById('clue').innerText = q.clue;
      showQRScanner();
      document.getElementById('question').innerHTML = '';
    } else {
      document.getElementById('clue').innerText = 'Gratulujeme! Najdƒõte posledn√≠ ob√°lku.';
      document.getElementById('question').innerHTML = '';
      clearInterval(timerInterval);
    }
  } else {
    alert('≈†patn√° odpovƒõƒè! Zkus to znovu.');
  }
}
</script>
</body>
</html>